# use container-based infrastructure
sudo: false
dist: trusty

# Ruby configuration
language: ruby
rvm:
  - 2.4.0
cache: bundler
bundler_args: --without development --jobs=3 --retry=3

env:
  global:
    - GIT_AUTHOR_EMAIL='tosainu.maple@gmail.com'
    - GIT_AUTHOR_NAME='Tosainu@travis-ci'
    - GIT_COMMITTER_EMAIL='tosainu.maple@gmail.com'
    - GIT_COMMITTER_NAME='Tosainu@travis-ci'
    - secure: 'dAPq0eWokH+U/K/cyqnXpy6BpdjIjvoWIZbbpYGusTZ4FzduTyb1e6Lv6Pu1KvJj2ujnU6lU3jDpjM9SCVyHz+zdVZcKRNbsQiZ0iWXoWg2a5BZiKG3RZ7wMGqs6rs7gwWa1waLN5lHECnxRTI2LaC8SyYzUWA5g7zUSe1sc9MU='

before_script:
  - git clone --quiet -b master https://github.com/Tosainu/tosainu.github.com.git build

script:
  - bundle exec middleman build

after_success:
  - '[ "$TRAVIS_BRANCH" == "dev" ] && bundle exec middleman deploy >/dev/null 2>&1'
